<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diario Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="config.js"></script>
</head>

<body class="bg-gray-100 text-gray-800 p-6">
    <h1 class="text-4xl font-bold text-center mb-6">Últimos Artículos</h1>
    <a href="create_post.html" class="block text-center mb-4 text-blue-500 hover:underline">Publicar Nuevo Artículo</a>
    <div id="posts" class="grid gap-4"></div>

    <script type="module">
        import { API_URL } from './config.js';

        async function loadPosts() {
            const response = await fetch(`${API_URL}/posts`);
            const posts = await response.json();
            const postsDiv = document.getElementById("posts");
            postsDiv.innerHTML = posts.map(post => `
                <div class="p-4 bg-white rounded shadow">
                    <h2 class="text-xl font-bold">${post.title}</h2>
                    <p class="text-gray-700">${post.content.slice(0, 100)}...</p>
                    <a href="post.html?id=${post.id}" class="text-blue-500 hover:underline">Leer más</a>
                    <button onclick="deletePost('${post.id}')" class="mt-2 text-red-500 hover:underline">Eliminar</button>
                </div>
            `).join("");
        }

        async function deletePost(postId) {
            await fetch(`${API_URL}/posts/${postId}`, { method: "DELETE" });
            loadPosts();
        }

        loadPosts();
    </script>
</body>

</html>